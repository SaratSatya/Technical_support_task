<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bundle & Save</title>
    <style>
      :root {
        --green: #0a7a68;
        --green-2: #0b8a76;
        --border: #d7d7d7;
        --text: #1c1c1c;
        --muted: #7a7a7a;
        --bg: #ffffff;
        --active-bg: #f1fbf8;
      }

      * { box-sizing: border-box; }
      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        background: #fff;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color: var(--text);
      }

      .wrap {
        width: min(520px, 92vw);
        padding: 18px 14px 24px;
      }

      .title {
        display: flex;
        align-items: center;
        gap: 14px;
        color: var(--green);
        font-weight: 700;
        justify-content: center;
        margin: 6px 0 16px;
      }
      .title::before,
      .title::after {
        content: "";
        height: 1px;
        background: #e7e7e7;
        flex: 1;
      }

      .bundle {
        border: 2px solid var(--border);
        border-radius: 10px;
        padding: 14px 14px;
        background: var(--bg);
        display: grid;
        grid-template-columns: 22px 1fr auto;
        column-gap: 12px;
        row-gap: 8px;
        cursor: pointer;
        transition: border-color 150ms ease, background 150ms ease;
        margin: 12px 0;
        user-select: none;
      }

      .bundle:hover { border-color: #c9c9c9; }

      .bundle.active {
        border-color: var(--green);
        background: var(--active-bg);
      }

      .radio {
        width: 18px;
        height: 18px;
        border-radius: 999px;
        border: 2px solid #bdbdbd;
        margin-top: 4px;
        position: relative;
      }
      .bundle.active .radio { border-color: var(--green); }
      .bundle.active .radio::after {
        content: "";
        position: absolute;
        inset: 3px;
        border-radius: 999px;
        background: var(--green);
      }

      .left { display: grid; gap: 4px; }

      .topRow {
        display: flex;
        align-items: baseline;
        gap: 10px;
        flex-wrap: wrap;
      }

      .pair { font-weight: 700; font-size: 15px; }
      .price { font-weight: 700; font-size: 15px; }

      .subRow {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
      }

      .strike {
        color: var(--muted);
        text-decoration: line-through;
        font-size: 12px;
      }

      .right {
        text-align: right;
        display: grid;
        gap: 4px;
        justify-items: end;
      }

      .tag {
        font-size: 12px;
        font-weight: 700;
        color: var(--green);
      }

      .off {
        font-weight: 800;
        font-size: 14px;
      }

      .details {
        grid-column: 2 / -1;
        display: none;
        padding: 6px 0 2px;
      }
      .bundle.active .details { display: block; }

      .hdrRow {
        display: grid;
        grid-template-columns: 28px 1fr 1fr;
        gap: 10px;
        align-items: center;
        margin-top: 8px;
      }

      .hdr {
        color: var(--muted);
        font-size: 12px;
        margin-bottom: 6px;
      }

      .grid {
        display: grid;
        grid-template-columns: 28px 1fr 1fr;
        gap: 10px 10px;
        align-items: center;
        margin-top: 8px;
      }

      .idx {
        color: var(--muted);
        font-size: 12px;
        font-weight: 700;
      }

      select {
        width: 100%;
        padding: 9px 10px;
        border: 1px solid #d6d6d6;
        border-radius: 8px;
        background: #fff;
        font-size: 14px;
        outline: none;
      }
      select:focus {
        border-color: var(--green);
        box-shadow: 0 0 0 3px rgba(10, 122, 104, 0.12);
      }

      .summary {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 14px;
        padding: 2px 2px;
        font-size: 14px;
      }
      .ship { color: var(--green); font-weight: 700; }
      .total strong { font-weight: 900; }

      .btn {
        width: 100%;
        border: none;
        border-radius: 12px;
        background: var(--green);
        color: #fff;
        padding: 14px 16px;
        font-weight: 800;
        font-size: 15px;
        cursor: pointer;
        margin-top: 12px;
      }
      .btn:hover { background: var(--green-2); }

      .powered {
        text-align: center;
        color: var(--muted);
        font-size: 12px;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="title">Bundle &amp; Save</div>

      <div id="bundleList"></div>

      <div class="summary">
        <div class="ship" id="shippingText">Free 2 Day Shipping</div>
        <div class="total">Total : <strong id="totalText">DKK 0.00</strong></div>
      </div>

      <button class="btn" id="addBtn">+ Add to Cart</button>
      <div class="powered">© Powered by Pumper</div>
    </div>

    <script>
      const currency = "DKK";

      // ✅ Now 1 Pair also expands (same as screenshot requirement)
      const bundles = [
        { id: "b1", pairs: 1, price: 195.0, offText: "50% OFF", tag: "", expandedRows: 2 },
        { id: "b2", pairs: 2, price: 345.0, offText: "40% OFF", tag: "Most Popular", expandedRows: 2, compareAtText: `${currency} 195.00` },
        { id: "b3", pairs: 3, price: 528.0, offText: "60% OFF", tag: "", expandedRows: 2 },
      ];

      const sizes = ["S", "M", "L", "XL"];
      const colors = ["colour", "Black", "White", "Green", "Blue"];

      const listEl = document.getElementById("bundleList");
      const totalEl = document.getElementById("totalText");
      const addBtn = document.getElementById("addBtn");

      let activeId = "b1"; // default selection (change to "b2" if you want 2-pair selected initially)

      function money(n) {
        return `${currency} ${Number(n).toFixed(2)}`;
      }

      function escapeHtml(str) {
        return String(str)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function renderSelect(id, options, selected) {
        const opts = options
          .map((o) => `<option value="${escapeHtml(o)}" ${o === selected ? "selected" : ""}>${escapeHtml(o)}</option>`)
          .join("");
        return `<select id="${id}" name="${id}">${opts}</select>`;
      }

      function setActive(id) {
        activeId = id;
        render();
      }

      function render() {
        listEl.innerHTML = "";

        bundles.forEach((b) => {
          const card = document.createElement("div");
          card.className = "bundle" + (b.id === activeId ? " active" : "");
          card.setAttribute("role", "button");
          card.setAttribute("tabindex", "0");
          card.dataset.id = b.id;

          const radio = document.createElement("div");
          radio.className = "radio";

          const left = document.createElement("div");
          left.className = "left";

          const topRow = document.createElement("div");
          topRow.className = "topRow";
          topRow.innerHTML = `
            <div class="pair">${b.pairs} Pair</div>
            <div class="price">${money(b.price)}</div>
          `;

          left.appendChild(topRow);

          if (b.compareAtText) {
            const subRow = document.createElement("div");
            subRow.className = "subRow";
            subRow.innerHTML = `<div class="strike">${b.compareAtText}</div>`;
            left.appendChild(subRow);
          }

          const right = document.createElement("div");
          right.className = "right";
          right.innerHTML = `
            ${b.tag ? `<div class="tag">${b.tag}</div>` : `<div></div>`}
            <div class="off">${b.offText}</div>
          `;

          const details = document.createElement("div");
          details.className = "details";

          if (b.expandedRows > 0) {
            details.innerHTML = `
              <div class="hdrRow">
                <div></div>
                <div class="hdr">Size</div>
                <div class="hdr">Colour</div>
              </div>
              <div class="grid">
                ${Array.from({ length: b.expandedRows })
                  .map((_, i) => {
                    const idx = i + 1;
                    return `
                      <div class="idx">#${idx}</div>
                      <div>${renderSelect(`size-${b.id}-${idx}`, sizes, "S")}</div>
                      <div>${renderSelect(`color-${b.id}-${idx}`, colors, "colour")}</div>
                    `;
                  })
                  .join("")}
              </div>
            `;
          }

          card.appendChild(radio);
          card.appendChild(left);
          card.appendChild(right);
          card.appendChild(details);

          card.addEventListener("click", () => setActive(b.id));
          card.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              setActive(b.id);
            }
          });

          listEl.appendChild(card);
        });

        const active = bundles.find((b) => b.id === activeId);
        totalEl.textContent = money(active.price);
      }

      addBtn.addEventListener("click", () => {
        const active = bundles.find((b) => b.id === activeId);

        // Collect dropdown selections (only from active card)
        const card = [...document.querySelectorAll(".bundle")].find((c) => c.dataset.id === activeId);
        const selects = card ? [...card.querySelectorAll("select")] : [];
        const selections = selects.map((s) => ({ name: s.name, value: s.value }));

        console.log("ADD TO CART", { bundle: active, selections });
        alert(`Added: ${active.pairs} Pair (${money(active.price)})`);
      });

      render();
    </script>
  </body>
</html>

